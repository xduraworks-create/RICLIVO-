open_banking_integration.md

Title: Open Banking Integration – Nordigen (GoCardless) and Partner APIs

Folder: /integrations/open_banking_integration.md


---

Purpose

Riclivo connects to users’ financial accounts through Open Banking APIs to:

Import transactions, balances, and account metadata.

Detect reclaimable charges (bank fees, failed deductions, etc.).

Automate tax bookkeeping and summaries.


All integrations comply with PSD2, CBN Open Banking, and GDPR data protection laws.


---

Primary Providers

Provider	Region	Function

Nordigen (GoCardless)	EU/UK	Free Open Banking API for bank data aggregation
Flutterwave	Africa / Global	Payments and virtual account funding
Paystack	Nigeria / West Africa	Local payments and merchant APIs
Okra / Mono (optional)	Africa	Bank connection expansion layer



---

Integration Architecture

User → Riclivo App (Glide)
     → Riclivo API Proxy (handles tokens securely)
     → Nordigen API
     → Bank
     ← Transaction + Account Data
     → Riclivo Sheets (accounts / transactions / ledger)


---

Key API Endpoints (Nordigen)

Function	Endpoint	Method	Description

Create Requisition	/requisitions/	POST	Start a new user-bank connection session
List Banks	/institutions/	GET	Fetch available banks by country
Fetch Accounts	/accounts/{id}	GET	Retrieve account metadata
Fetch Transactions	/accounts/{id}/transactions/	GET	Retrieve transactions for analysis



---

Token Management

Tokens are generated by Nordigen after user consents to link their bank.

Riclivo stores only:

token_status

token_scope

token_expires

connected_date


Full access tokens are never stored in plain text (only hashed).

Renewals follow config.default_token_validity_days.



---

User Consent Flow

1. User clicks “Connect My Bank”


2. Riclivo calls Nordigen /requisitions/ endpoint → redirects user to their bank login page.


3. User approves connection → redirected back to Riclivo success page.


4. Riclivo API fetches transactions and balance data.


5. Data written to:

accounts sheet

transactions sheet

ledger (optional summary)





---

Data Mapping Example

Riclivo Field	Nordigen Field	Example

bank_name	institution_name	“Zenith Bank”
account_owner_name	owner_name	“Ada Test”
masked_account	iban_masked	“****2345”
account_currency	currency	“NGN”
connected_date	created	“2025-10-05”
token_status	status	“Active”



---

Reclaim Detection

Once data is imported, Riclivo AI checks for:

Duplicate or failed charges

Excess bank fees

Tax-deductible expenses

Refundable failed transactions


Each detected case auto-populates a draft reclaim in the reclaims sheet.


---

Security & Compliance

✅ All Nordigen connections are user-consent based.
✅ Riclivo never stores bank credentials.
✅ Data is encrypted using AES-256 and stored in Google Sheets only as minimal metadata.
✅ Tokens automatically expire after the preset config.default_token_validity_days.
✅ Logs are anonymized for audit purposes.
✅ In-app AI uses only transaction summaries, never real account identifiers.


---

Fallback & Multi-Region Handling

If Nordigen isn’t supported in a user’s region:

Riclivo switches to Flutterwave (for Africa/global payments)

or Paystack / Okra for direct Nigerian bank links.

The selection logic is based on localization.country_code.



---

Error Handling

Error Type	System Response

Bank not available	Suggest alternative provider
Token expired	Prompt user to reconnect
API timeout	Retry up to 3 times, log error
Account mismatch	Lock session, alert admin



---

Future Expansion

Add Plaid (USA/Canada) for North America coverage

Add TrueLayer / SaltEdge for Asia-Pacific and Middle East

Introduce bank-level reclaim requests via direct API messages

Add transaction webhooks for real-time notifications



---

Sample Code Snippet (Python – Pseudo)

def fetch_transactions(account_id):
    url = f"https://ob.nordigen.com/api/v2/accounts/{account_id}/transactions/"
    headers = {"Authorization": f"Bearer {ACCESS_TOKEN}"}
    res = requests.get(url, headers=headers)
    data = res.json()
    # Transform and save to Riclivo schema
    save_to_sheet('transactions', data)
